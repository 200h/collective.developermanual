=========
Basics
=========

.. contents ::

Introduction
------------

In Plone, there is two not tightly coupled user subsystems

# Managing authentication and permission information (acl_users under site root),
  managed by Pluggable Authentication System (PAS)

# Managing member profile (portal_membership under site root)

Active user
-----------

Getting logged in member
========================

The following view method code will get the username for the logged in user.

Example::

    from Products.CMFCore.utils  import getToolByName

    def getActiveUser(self):
        """
        """

        mt = getToolByName(self.context, 'portal_membership')
        if mt.isAnonymousUser(): # the user has not logged in
            return None
        else:
            member = mt.getAuthenticatedMember()
            username = member.getUserName()
            return username


or in template::

    username context/portal_membership/getAuthenticatedMember/getUserName

Groups
------

Groups are stored as PloneGroup objects, which is subclass of PloneUser.

* https://svn.plone.org/svn/collective/Products.PlonePAS/trunk/Products/PlonePAS/plugins/ufactory.py

* https://svn.plone.org/svn/collective/Products.PlonePAS/trunk/Products/PlonePAS/plugins/group.py

Getting available groups
========================

Getting all groups on the site is possible through acl_users and source_groups folder which provide functionality to manipulate Plone groups.

Example to get only ids::

    acl_users = site.acl_users
    groups = acl.source_groups.getGroupIds() # Iterable of id strings

Example to get full group information::

    site = context.portal_url.getPortalObject()
    users = site.acl_users
    list = users.source_groups.getGroups()

    for group in list:
        # group is PloneGroup object
        yield (group.getName(), group.title)


Getting groups for a certain user
=================================

Below is an example how to get groups for the logged in user::


Automatic member creation
-------------------------

* http://plone.org/documentation/kb/batch-adding-users

Email login
-----------

* Plone 3 does not allow a dot in the username 

* Plone 4 default feature

* For Plone 3 see http://plone.org/products/betahaus.emaillogin